# Отток клиентов в телеком
# Цель исследования:
- Разработать модель прогнозирования оттока клиентов с метрикой roc_auc не менее 0.85

# Задачи:
- Подготовить не менее 3х моделей и выбрать лучшую по метрике roc_auc.

# Используемые библиотеки:
pandas, phik, numpy, seaborn, matplotlib, sklearn.

# Основные выводы:
**Провели исследование, согласно плану**

**1. Предварительный анализ.**
- Выгрузили данные из 4х датасетов с общим ключом `customerID`
- Выявили, что данные содержат достаточную для анализа информацию и составлен план работы.

**2. Исследовательский анализ.**
- Добавили целевой признак `Exited`(ушел клиент или нет). 
- Создали новый признак с количеством дней действия договора 'period'.
- Изменили типы данных, где это было необходимо.
- Проведена работа с пропущенными значениями
- Объединили таблицы в общий датасет по ключу *customerID*
- Изучили распределение значений целевого признака и сделали вывод - что имеем дело с серьёзным дисбалансом. В итоге:
    - Выбрали модели с встроенными средствами балансировки.
    - Применили сэмплирование количественных признаков для Логистической регрессии.
- Провели анализ на мультиколлинеарность.
- Провели отдельный анализ категориальных и количественных признаков в разрезе ушел/остался. Построили графики. 
- В итоге сформирован портрет ушедшего клиента:
- Разделили датасет на тренеровочну и тестову выборки.

**3. Обучение и выбор лучшей модели**
- Выделили категориальные и количественные признаки.
- На тренировочных выборках провели обучение моделей и получили результат:
| Model                       | roc_auc best_score   | roc_auc cross_val    | accuracy  |
| :-------------------------  |:------------------   |:------------------   | :-------- |
| RandomForestClassifier      | 0.862                | 0.860                |0.886      |
| LogisticRegression          | 0.847                | 0.847                |0.754      |
| GradientBoostingClassifier  | 0.900                | 0.894                |0.897      |
| DecisionTreeClassifier      | 0.818                | 0.820                |0.828      |

- Выбрали лучшую модель по метрике roc_auc на кросс-валидации. Рекомендована модель GradientBoostingClassifier с гиперпараметрами (max_depth=4, n_estimators=151)

**4.Тестирование лучшей модели**
- Проверили рекомендованную модель на тестовой выборке

| Score   | GradientBoostingClassifier |
| :-------|:------|
| Roc_auc | 0.897 |
| Accuracy | 0.854 |
| Presicion | 0.805 |
| Recall | 0.593 |

- Кривая ошибок модели получилась высокая. Значения TPR свидетельствуют о неплохом качестве модели.
- Вывели матрицу ошибок.\
Модель имеет высокие показатели истинно-положительных ответов (1227) и истинно-негативных (277). Хорошую точность и среднюю полноту. Учитывая, наличие дисбаланса, метрику полноты (Recall) можно увеличить, однако, идеальный баланс между Presicion и Recall следует определить совместно с бизнесом, в зависимости от целей. Например, можно сосредоточиться на удержании vip-клинетов, которые приносят больше прибыли или тратить меньше денег на маркетинг, потенциально ушедших в будующем.
- Вывели график важности признаков итоговой модели. Выделили ТОП 5 самых важных для обучения:

| Признаки | Важность |
| :-------|:------|
| Period | 	0.402297 | 
| Type	| 0.267886 |
| MonthlyCharges |  0.151432 |
| TotalCharges	| 0.091928 |
| InternetService | 0.019314 |
