# Восстановление золота из руды

Компания разрабатывает решения для эффективной работы промышленных предприятий.

## Цель исследования:
- Подготовить прототип модели машинного обучения.
- Модель должна помочь оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Задачи:
- Проверить формулу вычисления эффективности обогащения
- Проанализировать признаки, недоступные в тестовой выборке
- Проанализировать распределения размеров гранул на обучающей и тестовой выборках
- Исследовать суммарные концентрации
- Обучить и проверить несколько моделей
- Выбрать лучшую модель, и проверить ее качество на тестовой выборке
- Написать функцию для вычисления итогового sMAPE:
- Нужно спрогнозировать сразу две величины:
    - эффективность обогащения чернового концентрата rougher.output.recovery;
    - эффективность обогащения финального концентрата final.output.recovery.
    - Итоговая метрика складывается из двух величин: 25% * sMAPE(rougher) + 75% * sMAPE(final)
    
## Условия задачи:
- Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
- В нашем распоряжении сырые данные: их просто выгрузили из хранилища.
- Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. 
- Необходимо использовать данные с параметрами добычи и очистки. 
- Эффективность обогащения рассчитывается по формуле: 

Recovery = C*(F-T) / F*(C-T) * 100%

    C — доля золота в концентрате после флотации/очистки;
    F — доля золота в сырье/концентрате до флотации/очистки;
    T — доля золота в отвальных хвостах после флотации/очистки.

- sMAPE = (1/n) * Σ(|прогноз – фактический| / ((|прогноз| + |фактический|)/2) * 100%
  
# Используемые библиотеки
pandas, seaborn, matplotlib, numpy, sklearn.

# Основные выводы
- Рассмотрели модели: DecisionTreeRegressor, RandomForestRegressor и LinearRegression. Оценили их качество кросс-валидацией.
- Рекомендуемая модель RandomForestRegressor с гиперпараметрами: max_depth=4, n_estimators=30 для чернового концентрата и max_depth=4, n_estimators=40 для финального концентрата. Итоговый sMAPE = 8.42
- Модель проверена на адекватность, с помощью DummyRegressor. sMAPE случайной модели = 9.8, что значительно вышее выбранной нами модели.
- Модель RandomForestRegressor проверена на тестовой выборке. Итоговый sMAPE = 9.20
